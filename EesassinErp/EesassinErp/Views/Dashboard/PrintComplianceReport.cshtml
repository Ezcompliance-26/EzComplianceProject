@{
    ViewBag.Title = "Print Compliance Report";
    Layout = "~/Views/Common/_IframeMaster.cshtml";
    ViewBag.Version = System.Configuration.ConfigurationManager.AppSettings["version"];

}
<script src="~/scripts/myjslib/AuditorComplianceController.js"></script>
<link rel="stylesheet" media="print" href="~/content/css/print.css" />
 <style type="text/css">
    body, div, table, thead, tbody, tfoot, tr, th, td, p {
        font-family: "Arial";
        font-size: x-small;
    }

    a.comment-indicator:hover + comment {
        background: #ffd;
        position: absolute;
        display: block;
        border: 1px solid black;
        padding: 0.5em;
    }

    a.comment-indicator {
        background: red;
        display: inline-block;
        border: 1px solid black;
        width: 0.5em;
        height: 0.5em;
    }

    comment {
        display: none;
    }
    /* body, div, table, thead, tbody, tfoot, tr, th, td, p {
           font-family: "Arial";
           font-size: x-small;
           border: 1px solid;
       } */
    /* reset */

    * {
        border: 0;
        box-sizing: content-box;
        color: black;
        font-family: inherit;
        font-size: inherit;
        font-style: inherit;
        font-weight: inherit;
        line-height: inherit;
        list-style: none;
        margin: 0;
        padding: 0;
        text-decoration: none;
        vertical-align: top;
    }

        /* content editable */

        *[contenteditable] {
            border-radius: 0.25em;
            min-width: 1em;
            outline: 0;
        }

        *[contenteditable] {
            cursor: pointer;
        }

            *[contenteditable]:hover, *[contenteditable]:focus, td:hover *[contenteditable], td:focus *[contenteditable], img.hover {
                background: #DEF;
                box-shadow: 0 0 1em 0.5em #DEF;
            }

    span[contenteditable] {
        display: inline-block;
    }

    /* heading */

    h1 {
        font: bold 100% sans-serif;
        letter-spacing: 0.5em;
        text-align: center;
        text-transform: uppercase;
    }

    /* table */

    table {
        font-size: 75%;
        table-layout: auto;
        width: 100%;
    }

    table {
        border-collapse: separate;
        border-spacing: 2px;
    }

    th, td {
        border-width: 1px;
        padding: 0.5em;
        position: relative;
        text-align: left;
    }

    th, td {
        border-radius: 0.25em;
        border-style: solid;
    }

    th {
        background: #EEE;
        border-color: #BBB;
    }

    td {
        border-color: #DDD;
        height: auto;
    }

    /* page */

    html {
        font: 16px/1 'Open Sans', sans-serif;
        overflow: auto;
        padding: 0.5in;
    }

    html {
        background: #fff;
        cursor: default;
        margin: 0 !important;
        padding: 0;
    }

    body {
        box-sizing: border-box;
        margin: 0 auto;
        padding: 0.5in;
        width: 100%;
    }

    body {
        background: #FFF;
        border-radius: 1px;
        box-shadow: 0 0 1in -0.25in rgba(0, 0, 0, 0.5);
    }

    /* header */

    header {
        margin: 0 0 3em;
    }

        header:after {
            clear: both;
            content: "";
            display: table;
        }

        header h1 {
            background: #000;
            border-radius: 0.25em;
            color: #FFF;
            margin: 0 0 1em;
            padding: 0.5em 0;
        }

        header address {
            float: left;
            font-size: 75%;
            font-style: normal;
            line-height: 1.25;
            margin: 0 1em 1em 0;
        }

            header address p {
                margin: 0 0 0.25em;
            }

        header span, header img {
            display: block;
            float: right;
        }

        header span {
            margin: 0 0 1em 1em;
            max-height: 25%;
            max-width: 60%;
            position: relative;
        }

        header img {
            max-height: 100%;
            max-width: 100%;
        }

        header input {
            cursor: pointer;
            -ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=0)";
            height: 100%;
            left: 0;
            opacity: 0;
            position: absolute;
            top: 0;
            width: 100%;
        }

    /* article */

    article, article address, table.meta, table.inventory {
        margin: 0 0 3em;
    }

        article:after {
            clear: both;
            content: "";
            display: table;
        }

        article h1 {
            clip: rect(0 0 0 0);
            position: absolute;
        }

        article address {
            float: left;
            font-size: 125%;
            font-weight: bold;
        }

    /* table meta & balance */

    table.meta, table.balance {
        float: right;
        width: 36%;
    }

        table.meta:after, table.balance:after {
            clear: both;
            content: "";
            display: table;
        }

        /* table meta */

        table.meta th {
            width: 40%;
        }

        table.meta td {
            width: 60%;
        }

    /* table items */

    table.inventory {
        clear: both;
        width: 100%;
    }

        table.inventory th {
            font-weight: bold;
            text-align: center;
        }

        table.inventory td:nth-child(1) {
            width: 26%;
        }

        table.inventory td:nth-child(2) {
            width: 38%;
        }

        table.inventory td:nth-child(3) {
            text-align: right;
            width: 12%;
        }

        table.inventory td:nth-child(4) {
            text-align: right;
            width: 12%;
        }

        table.inventory td:nth-child(5) {
            text-align: right;
            width: 12%;
        }

    /* table balance */

    table.balance th, table.balance td {
        width: 50%;
    }

    table.balance td {
        text-align: right;
    }

    /* aside */

    aside h1 {
        border: none;
        border-width: 0 0 1px;
        margin: 0 0 1em;
    }

    aside h1 {
        border-color: #999;
        border-bottom-style: solid;
    }

    /* javascript */

    .add, .cut {
        border-width: 1px;
        display: block;
        font-size: .8rem;
        padding: 0.25em 0.5em;
        float: left;
        text-align: center;
        width: 0.6em;
    }

    .add, .cut {
        background: #9AF;
        box-shadow: 0 1px 2px rgba(0,0,0,0.2);
        background-image: -moz-linear-gradient(#00ADEE 5%, #0078A5 100%);
        background-image: -webkit-linear-gradient(#00ADEE 5%, #0078A5 100%);
        border-radius: 0.5em;
        border-color: #0076A3;
        color: #FFF;
        cursor: pointer;
        font-weight: bold;
        text-shadow: 0 -1px 2px rgba(0,0,0,0.333);
    }

    .add {
        margin: -2.5em 0 0;
    }

        .add:hover {
            background: #00ADEE;
        }

    .cut {
        opacity: 0;
        position: absolute;
        top: 0;
        left: -1.5em;
    }

    .cut {
        -webkit-transition: opacity 100ms ease-in;
    }

    tr:hover .cut {
        opacity: 1;
    }
</style>
<div style="text-align: right;">
    <ol class="breadcrumb">
        <li><span>DashBoard</span></li>
        <li><span>Report</span></li>
        <li class="active"><span>Compliance Report</span></li>
    </ol>
</div>
<div id="printDiv" ng-cloak>
  <table style="border:2px solid #ccc;margin-bottom:10px; padding:10px; width:100%" ng-init="LoadData()" >
        <tr>
            <td style="color: #fff !important; border: none; font-size: 18px; text-align: center;   background-image: linear-gradient(#dd3623,#e77f27);
padding: 0.5em; " colspan=9 height="27">
                COMPLIANCE AUDIT REPORT [{{DocumentStatus}}  ]
            </td>
           
        </tr>
    </table>

    <table style="border:2px solid #ccc;margin-bottom:10px; padding:10px; width:100%">
        <tr>
            <th colspan="2" style="background: #f0decf;border-color: #BBB; text-align:center;">Client</th>
            <th colspan="2" style="background: #f0decf;border-color: #BBB; text-align:center;">Vendor</th>
        </tr>
        <tr>
            <td style="border-color: #DDD;height: auto;border: 1px solid #ddd;border-radius: 2px;padding: 5px 9px;">
                Client Name
            </td>
            <td style="border-color: #DDD;height: auto;border: 1px solid #ddd;border-radius: 2px;padding: 5px 9px;">
                {{ClientName}}
            </td>
            <td style="border-color: #DDD;height: auto;border: 1px solid #ddd;border-radius: 2px;padding: 5px 9px;">
                Authorized Person Name
            </td>
            <td style="border-color: #DDD;height: auto;border: 1px solid #ddd;border-radius: 2px;padding: 5px 9px;"> 
                {{PartyName}} 
            </td>
        </tr>
        <tr>
            <td style="border-color: #DDD;height: auto;border: 1px solid #ddd;border-radius: 2px;padding: 5px 9px;">
                State
            </td>
            <td style="border-color: #DDD;height: auto;border: 1px solid #ddd;border-radius: 2px;padding: 5px 9px;">
                {{StateName}}
            </td>
            <td style="border-color: #DDD;height: auto;border: 1px solid #ddd;border-radius: 2px;padding: 5px 9px;">
                UserName
            </td>
            <td style="border-color: #DDD;height: auto;border: 1px solid #ddd;border-radius: 2px;padding: 5px 9px;">
                {{VenderSite}}
            </td>
        </tr>
        <tr>
            <td style="border-color: #DDD;height: auto;border: 1px solid #ddd;border-radius: 2px;padding: 5px 9px;">
                Issue Date
            </td>
            <td style="border-color: #DDD;height: auto;border: 1px solid #ddd;border-radius: 2px;padding: 5px 9px;">
                {{IssueDate}}
            </td>
            <td style="border-color: #DDD;height: auto;border: 1px solid #ddd;border-radius: 2px;padding: 5px 9px;">
                Vendor Site
            </td>
            <td style="border-color: #DDD;height: auto;border: 1px solid #ddd;border-radius: 2px;padding: 5px 9px;">
                --
            </td>
        </tr>
        <tr>
            <td style="border-color: #DDD;height: auto;border: 1px solid #ddd;border-radius: 2px;padding: 5px 9px;">
                Site Name
            </td>
            <td style="border-color: #DDD;height: auto;border: 1px solid #ddd;border-radius: 2px;padding: 5px 9px;">
                {{SiteName}}
            </td>
            <td style="border-color: #DDD;height: auto;border: 1px solid #ddd;border-radius: 2px;padding: 5px 9px;">
                Contact
            </td>
            <td style="border-color: #DDD;height: auto;border: 1px solid #ddd;border-radius: 2px;padding: 5px 9px;">
                {{ContactNo}}
            </td>
        </tr>
        <tr>
            <td style="border-color: #DDD;height: auto;border: 1px solid #ddd;border-radius: 2px;padding: 5px 9px;">
                Location
            </td>
            <td style="border-color: #DDD;height: auto;border: 1px solid #ddd;border-radius: 2px;padding: 5px 9px;">
                {{Location}}
            </td>
            <td style="border-color: #DDD;height: auto;border: 1px solid #ddd;border-radius: 2px;padding: 5px 9px;">
                Email ID
            </td>
            <td style="border-color: #DDD;height: auto;border: 1px solid #ddd;border-radius: 2px;padding: 5px 9px;">
                {{Email}}
            </td>
        </tr>
        <tr>
            <td style="border-color: #DDD;height: auto;border: 1px solid #ddd;border-radius: 2px;padding: 5px 9px;">
                Upload Document Count :  {{TUDC}}
            </td>
            <td style="border-color: #DDD;height: auto;border: 1px solid #ddd;border-radius: 2px;padding: 5px 9px;">
                Total Document Count :  {{TDC}}
            </td>
           
            <td style="border-color: #DDD;height: auto;border: 1px solid #ddd;border-radius: 2px;padding: 5px 9px;">
                Vendor Company Name
            </td>
            <td style="border-color: #DDD;height: auto;border: 1px solid #ddd;border-radius: 2px;padding: 5px 9px;">
                {{CompanyName}}
            </td>
           
        </tr>
        <tr ng-show="IsUploadAQ =='1'" >
            <td style="border-color: #DDD;height: auto;border: 1px solid #ddd;border-radius: 2px;padding: 5px 9px;" colspan="2">
               
            </td>
           
            <td style="border-color: #DDD;height: auto;border: 1px solid #ddd;border-radius: 2px;padding: 5px 9px;"  >
                <div ng-show="{{AuditOn}}==''?false:true"><div >  Vendor Query</div>  </div> 
            
            </td>
            <td style="border-color: #DDD;height: auto;border: 1px solid #ddd;border-radius: 2px;padding: 5px 9px;"  >
                <div class="hidecss" ng-show="FinalSave !='2'">
                    <div class="hidecss" ng-show="NotOpenforClient =='2'">
                        <div ng-show="IsUploadAQ =='1'"> 
                            <input type="file" id="fuCandidatePhoto" ng-hide="IsUploadVENQ =='2'" onchange="angular.element(this).scope().showVendor(this, '#AlbumIcon')">
                        </div>
                       
                    </div>
                </div>

                    <div ng-show="OpenFlag=='1' && NotOpenforClient =='3' && IsUploadVENQ !='3' ">
                        <a class="hidecss" target="_blank" ng-show="IsUploadVENQ =='1'||IsUploadVENQ =='2'" href="{{VendorQuery}}" download>Download Vendor Query</a>
                    </div>
                    <div ng-show="NotOpenforClient =='2' && IsUploadVENQ !='3'">
                        <a class="hidecss" target="_blank" ng-show="IsUploadVENQ =='1'||IsUploadVENQ =='2'" href="{{VendorQuery}}" download>Download Vendor Query</a>
                    </div>
                    <div ng-show="OpenFlag=='1' && NotOpenforClient =='4'">
                        <a class="hidecss" target="_blank" ng-show="IsUploadVENQ =='1'||IsUploadVENQ =='2'" href="{{VendorQuery}}" download>Download Vendor Query</a>
                    </div>
                    <p ng-show="IsUploadVENQ =='3'" style="color:red">{{RejectOn}}</p>
                    <p ng-show="IsUploadVENQ =='2'" style="color:darkgreen">{{ApproveOn}}</p>
                    <p>{{Remark}}</p>

</td>
          

        </tr>
        <tr>
            <th colspan="2">
                Invoice Details
            </th>
            <th colspan="2">
                Audit Details
            </th>
        </tr>



        <tr>

            <td style="border-color: #DDD;height: auto;border: 1px solid #ddd;border-radius: 2px;padding: 5px 9px;">
                {{TypeInvoice}}
            </td>
            <td style="border-color: #DDD;height: auto;border: 1px solid #ddd;border-radius: 2px;padding: 5px 9px;">
                {{VendorInvNum}}
            </td>
            <td style="border-color: #DDD;height: auto;border: 1px solid #ddd;border-radius: 2px;padding: 5px 9px;">
                Name of Auditor
            </td>
            <td style="border-color: #DDD;height: auto;border: 1px solid #ddd;border-radius: 2px;padding: 5px 9px;">
                {{Auditer}}
            </td>
        </tr>
        <tr>
            <td style="border-color: #DDD;height: auto;border: 1px solid #ddd;border-radius: 2px;padding: 5px 9px;">
                {{InvoiceDate}}
            </td>
            <td style="border-color: #DDD;height: auto;border: 1px solid #ddd;border-radius: 2px;padding: 5px 9px;">
                {{InvDate}}
            </td>
            <td style="border-color: #DDD;height: auto;border: 1px solid #ddd;border-radius: 2px;padding: 5px 9px;">
                Audit Score
            </td>
            <td style="border-color: #DDD;height: auto;border: 1px solid #ddd;border-radius: 2px;padding: 5px 9px;">
                Score Obtained :  &nbsp; &nbsp;   {{TotalComplianceScoreAchieved}}
            </td>
        </tr>
        <tr>
            <td style="border-color: #DDD;height: auto;border: 1px solid #ddd;border-radius: 2px;padding: 5px 9px;">
                Date of Document Upload
            </td>
            <td style="border-color: #DDD;height: auto;border: 1px solid #ddd;border-radius: 2px;padding: 5px 9px;">
                {{DocDate}}
            </td>

            <td style="border-color: #DDD;height: auto;border: 1px solid #ddd;border-radius: 2px;padding: 5px 9px;">
                Compliance Score %
            </td>
            <td style="border-color: #DDD;height: auto;border: 1px solid #ddd;border-radius: 2px;padding: 5px 9px;">
                &nbsp; &nbsp; {{ScorePer}}%
            </td>
        </tr>
        <tr>

            <td style="border-color: #DDD;height: auto;border: 1px solid #ddd;border-radius: 2px;padding: 5px 9px;">
                 Amount
            </td>
            <td style="border-color: #DDD;height: auto;border: 1px solid #ddd;border-radius: 2px;padding: 5px 9px;">
                {{grossAmount}}
            </td>
            <td style="border-color: #DDD;height: auto;border: 1px solid #ddd;border-radius: 2px;padding: 5px 9px;">
                Date of Audit Report
            </td>
            <td style="border-color: #DDD;height: auto;border: 1px solid #ddd;border-radius: 2px;padding: 5px 9px;">
                {{AuditDate}}
            </td>

        </tr>
        <tr>
            <td style="border-color: #DDD;height: auto;border: 1px solid #ddd;border-radius: 2px;padding: 5px 9px;">
                Audit Month
            </td>
            <td style="border-color: #DDD;height: auto;border: 1px solid #ddd;border-radius: 2px;padding: 5px 9px;">
                {{MONTH}}
            </td>
            @*<td style="border-color: #DDD;height: auto;border: 1px solid #ddd;border-radius: 2px;padding: 5px 9px;">
                Nature of Work
            </td>
            <td style="border-color: #DDD;height: auto;border: 1px solid #ddd;border-radius: 2px;padding: 5px 9px;">
                --
            </td>*@
            <td style="border-color: #DDD;height: auto;border: 1px solid #ddd;border-radius: 2px;padding: 5px 9px;">
               <div ng-show="{{AuditOn}}==''?false:true">Auditor Query</div> 
            </td>
            <td style="border-color: #DDD;height: auto;border: 1px solid #ddd;border-radius: 2px;padding: 5px 9px;">

                <div  class="hidecss"><a target="_blank" ng-show="IsUploadAQ =='1'" href="{{AuditorQuery}}" download>Download Auditor Query</a></div>
                <p ng-show="IsUploadAQ =='1'" style="color:darkgreen">{{AuditOn}}</p> 
                <p ng-show="IsUploadAQ !='1'" style="color:darkgreen">--</p> 
            </td>
        </tr>

    </table>  
    <table>
        <tr style="background-color: #b4b4b4; ">
              <td style="border-color: #DDD;height: auto;border: 1px solid #ddd;border-radius: 2px;padding: 5px 9px;">SNO</td>
              <td style="border-color: #DDD;height: auto;border: 1px solid #ddd;border-radius: 2px;padding: 5px 9px;">Act</td>
              <td style="border-color: #DDD;height: auto;border: 1px solid #ddd;border-radius: 2px;padding: 5px 9px;">Forms/Description (Applicability and Form No. shall be checked in the Help menu)</td>
              <td style="border-color: #DDD;height: auto;border: 1px solid #ddd;border-radius: 2px;padding: 5px 9px;">Nature of Compliance</td>
              <td style="border-color: #DDD;height: auto;border: 1px solid #ddd;border-radius: 2px;padding: 5px 9px;">Compliance Score</td>
              <td style="border-color: #DDD;height: auto;border: 1px solid #ddd;border-radius: 2px;padding: 5px 9px;">Compliance Score achieved</td>
              <td style="border-color: #DDD;height: auto;border: 1px solid #ddd;border-radius: 2px;padding: 5px 9px;">Compliance Status</td>
              <td style="border-color: #DDD;height: auto;border: 1px solid #ddd;border-radius: 2px;padding: 5px 9px;">Auditor Remarks</td>
              <td style="border-color: #DDD;height: auto;border: 1px solid #ddd;border-radius: 2px;padding: 5px 9px;">Vendor Remarks</td>
        </tr>
        <tr ng-repeat="x in DocList">
              <td style="border-color: #DDD;height: auto;border: 1px solid #ddd;border-radius: 2px;padding: 5px 9px;">
                <input type="hidden" ng-model="AuditorList[$index].DocId" ng-init="AuditorList[$index].DocId=x.Id" />
                <input type="hidden" ng-model="AuditorList[$index].SrNo" ng-init="AuditorList[$index].SrNo=x.Id" value="{{x.Id}}" />
                {{x.SRNO}}
              <td style="border-color: #DDD;height: auto;border: 1px solid #ddd;border-radius: 2px;padding: 5px 9px;" ng-init="AuditorList[$index].Act=x.Act">{{x.Act}}</td>
              <td style="border-color: #DDD;height: auto;border: 1px solid #ddd;border-radius: 2px;padding: 5px 9px;" ng-init="AuditorList[$index].Form=x.Form">{{x.Form}}</td>
              <td style="border-color: #DDD;height: auto;border: 1px solid #ddd;border-radius: 2px;padding: 5px 9px;" ng-init="AuditorList[$index].Nature=x.Nature">{{x.Nature}} </td>
              <td style="border-color: #DDD;height: auto;border: 1px solid #ddd;border-radius: 2px;padding: 5px 9px;" ng-init="AuditorList[$index].ComplianceScore=x.ComplianceScore">{{x.ComplianceScore}} </td>
              <td style="border-color: #DDD;height: auto;border: 1px solid #ddd;border-radius: 2px;padding: 5px 9px;" ng-init="AuditorList[$index].ComplianceScoreAchieved=x.ComplianceScoreAchieved">{{x.ComplianceScoreAchieved}} </td>
              <td style="border-color: #DDD;height: auto;border: 1px solid #ddd;border-radius: 2px;padding: 5px 9px;" ng-init="AuditorList[$index].CSS=x.CSS">{{x.CSS}} </td>
            <td style="border-color: #DDD;height: auto;border: 1px solid #ddd;border-radius: 2px;padding: 5px 9px;" ng-init="AuditorList[$index].Remark=x.Remark">{{x.Remark}} </td>
            <td style="border-color: #DDD;height: auto;border: 1px solid #ddd;border-radius: 2px;padding: 5px 9px;" ng-init="AuditorList[$index].VendorRemark=x.VendorRemark"> 
               <p ng-show="FinalSave =='2'"  >{{x.VendorRemark}}</p>
                <div ng-hide="FinalSave =='2'">
                    <textarea type="text" class="form-control-capitalize hidecss" ng-disabled="NotOpenforClient !='2'" ng-model="AuditorList[$index].VendorRemark" onkeyup="this.value = this.value.replace(/[^a-zA-Z0-9'! ?.-]+/g, '')" ng-init="AuditorList[$index].VendorRemark=x.VendorRemark"></textarea>
                </div>
               
             </td> 
        </tr>
        <tr>
            <td colspan="3"></td>
              <td style="border-color: #DDD;height: auto;border: 1px solid #ddd;border-radius: 2px;padding: 5px 9px;">
                Total :
            </td>
              <td style="border-color: #DDD;height: auto;border: 1px solid #ddd;border-radius: 2px;padding: 5px 9px;" ng-init="AuditorList[$index].TotalComplianceScore=x.TotalComplianceScore">{{TotalComplianceScore}}</td>
              <td style="border-color: #DDD;height: auto;border: 1px solid #ddd;border-radius: 2px;padding: 5px 9px;" ng-init="AuditorList[$index].TotalComplianceScoreAchieved=x.TotalComplianceScoreAchieved">{{TotalComplianceScoreAchieved}}</td>
            <td colspan="3"></td>
        </tr>

    </table> 
</div>
    <table>
    <tr>
    <td colspan="2"><button id="btnPrint" type="button" value="Print" class="btn2 btn-common btn-3 btn-3d pe-7s-print"
    name="printButton" ng-model="Print" ng-click="PrintRecord()">
    <span class="triangle-box" title="Print"></span>
    <span>Print </span>
    </button></td>
    <td  ng-show="NotOpenforClient =='2'"  >
        <button id="btnSave"   type="button" value="Save" class="btn2 btn-common btn-3 btn-3d pe-7s-Save" ng-disabled="FinalSave =='2'"
    name="SaveButton" ng-model="Save" ng-click="VendorDraftRecord()">
    <span class="triangle-box" title="Print"></span>
    <span>Save </span>
    </button></td>
    </></table>


<!-- ************************************************************************** -->
